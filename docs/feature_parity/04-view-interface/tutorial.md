# Tutorial – Feature 3.4 (View & Interface)（教學 – 功能 3.4：檢視與介面）

This walkthrough shows how to exercise the new layout and theme tooling that powers the RustNotePad UI preview.  
本教學示範如何操作 RustNotePad UI 預覽所使用的版面與主題工具。

## 1. Inspect layout state / 查看版面狀態

```bash
cat assets/layout-preview.json # eventually generated by the GUI
```

- `layout.split_ratio` controls the width of the secondary view (values between `0.1` and `0.9`).  
  `layout.split_ratio` 控制次要視圖寬度（介於 `0.1`~`0.9`）。
- `panes[].tabs[]` include `is_pinned`, `is_locked`, and optional `color` tags (`blue|green|orange|purple|red`).  
  `panes[].tabs[]` 內含 `is_pinned`、`is_locked` 與可選的 `color` 標記（`blue|green|orange|purple|red`）。
- `bottom_dock.visible_panels` declares the order of the Find Results / Console / Notifications / LSP tabs.  
  `bottom_dock.visible_panels` 指定底部停駐區中搜尋結果、主控台、通知、LSP 面板的順序。

Programmatically round-trip a layout configuration:  
以程式方式對版面設定進行往返驗證：

```rust
use rustnotepad_settings::LayoutConfig;

let layout = LayoutConfig::default();
let json = layout.to_json()?;
let restored = LayoutConfig::from_json(&json)?;
assert_eq!(layout, restored);
```

## 2. Load and switch themes / 載入並切換主題

Theme files live under `assets/themes/*.json`. Create a new theme by copying one of the shipped examples:  
主題檔案位於 `assets/themes/*.json`。可複製範例檔案建立新主題：

```bash
cp assets/themes/midnight_indigo.json assets/themes/my_rust_theme.json
```

Adjust the `palette` colours and `fonts` (sizes expressed in points). The GUI preview picks up new files on restart.  
調整 `palette` 色彩與 `fonts`（使用點數表示大小）。GUI 預覽重新啟動後會載入新檔案。

You can also load themes from an arbitrary directory:  
也可以從任意目錄載入主題：

```rust
use rustnotepad_settings::ThemeManager;

let mut manager = ThemeManager::load_from_dir("./assets/themes")?;
println!("Available themes: {:?}", manager.theme_names().collect::<Vec<_>>());
manager.set_active_by_name("Nordic Daylight");
let palette = manager.active_palette();
assert_eq!(palette.accent.r, 0x3B);
```

## 3. UI preview interactions / UI 預覽互動

Running the GUI (`cargo run -p rustnotepad_gui`) now provides:  
執行 GUI（`cargo run -p rustnotepad_gui`）目前提供：

- Theme and UI-language selectors in the toolbar (Backed by `ThemeManager` + status bar state).  
  工具列上的主題與語言選擇器（由 `ThemeManager` 與狀態列狀態支援）。
- Tab strip with pin/lock markers and colour tags; clicking tabs updates the layout state.  
  分頁列顯示釘選/鎖定標記與顏色標籤；點擊分頁會更新版面狀態。
- Split panes (primary editable, secondary preview) with adjustable ratio.  
  可調整比例的分割窗格（主窗格可編輯、副窗格為預覽）。
- Bottom dock tabs for Find Results / Console / Notifications / LSP diagnostics.  
  底部停駐面板包含搜尋結果、主控台、通知與 LSP 診斷分頁。
- Status bar metrics (line/column, selection, encoding, language, theme, UI language).  
  狀態列顯示行列位置、選取範圍、編碼、語言、主題與介面語言。

> **Tip 提示：** RustNotePad 會自動尋找系統常見的繁中字型（微軟正黑體、蘋方、Noto Sans TC 等）。若仍出現豆腐字，可手動將 `NotoSansTC-Regular.otf` 放入 `assets/fonts/` 後重新啟動。

These surfaces will be reused by the production Tauri shell once the core editor and persistence layers are bolted in, so exercising them now validates the new state providers.  
在核心編輯器與持久化層接入後，正式的 Tauri 外殼也會重用這些介面，因此現在就操作可以先驗證新的狀態來源。
